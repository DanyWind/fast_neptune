---

title: fast-neptune

keywords: fastai
sidebar: home_sidebar

summary: "Quickly track your Jupyter Notebook experiments with NeptuneML"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fast-neptune</code> is a library that helps you quickly record all the information you need to launch your experiments, when you are using Jupyter Notebooks. Reproducibility has become a crucial issue in Machine Learning, not only for research, but also for real world applications, where we want to have robust results, and track every set of parameters tested, along with their results.</p>
<p><code>fast-neptune</code> spirit is highly inspired from <a href="http://nbdev.fast.ai/">nbdev</a> in the user experience, so it is recommended to have a look first at it.</p>
<p>Furthermore, <code>fast-neptune</code> is built upon the solution <a href="https://neptune.ai/">neptune-ml</a> which allows users to quickly record on a public or private repository. Following the <a href="https://docs.neptune.ai/python-api/introduction.html">quick introduction</a> is a plus to understand <code>fast-neptune</code>, but as we will see it's quite intuitive.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fast-neptune</code> is available on pypi so you can simply run :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install fast-neptune</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fast-neptune</code> has implemend several features to help you when you run ML experiments.
These include :</p>
<ul>
    <li>metadata about the machine where the code is run, including OS, and OS version</li>
    <li>requirements of the notebook where the experiments are run</li>
    <li>parameters used during the experience, which means the names of the values of the variables you want to track</li>
    <li>code you used during the run that you want to record</li>
</ul><p>Note that code and parameters are not mandatorily tracked, while the two former are, though the whole purpose of this library is to facilitate the tracking of parameters and code.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Metadata">Metadata<a class="anchor-link" href="#Metadata">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Metadata is tracked about the requirements used and information about the Python version and OS used.</p>
<p>They are added automatically when an experiment is created, through the functions <a href="/fast_neptune/core#get_metadata"><code>get_metadata</code></a> and <a href="/fast_neptune/core#create_requirements"><code>create_requirements</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Property">Property<a class="anchor-link" href="#Property">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Properties refer to variables you want to record.</p>
<p>To record properties, simply add <code>#property</code> to each cell containing the variables you want to record.</p>
<p>Note : if one variable in a property is a file encapsulated in a <code>Path</code> object, it is automatically tracked, and this file will be sent to NeptuneML. You can disable this option when creating the experiment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Code">Code<a class="anchor-link" href="#Code">&#182;</a></h3><p>Code cells can also be tracked.</p>
<p>To do so, simply add <code>#code</code> to each cell you want to record. You have the possibility to specify under what name the cell code will be registered. By default, all cells with <code>#code</code> will be added chronogically to the file "main.py", but if you can put them in specific files by adding the name of the module you want them to be put in.</p>
<p>Example : add <code>#code dataloading.py</code> to the cells that take care of the data loading.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-with-fastai-vision-to-train-a-MNIST-classifier">Example with fastai vision to train a MNIST classifier<a class="anchor-link" href="#Example-with-fastai-vision-to-train-a-MNIST-classifier">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To understand more how all of this fit in, we will follow a simple example, using fastai library.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we will log in using NeptuneML</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Neptune login</span>
<span class="kn">from</span> <span class="nn">neptune.sessions</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">import</span> <span class="nn">getpass</span>

<span class="c1"># First we get the token</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s2">&quot;Please enter your NeptuneML API token : &quot;</span><span class="p">)</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">api_token</span><span class="o">=</span><span class="n">api_token</span><span class="p">)</span>

<span class="c1"># Then we enter user name and project</span>
<span class="n">user_name</span> <span class="o">=</span> <span class="s2">&quot;danywin&quot;</span>
<span class="n">project_name</span> <span class="o">=</span> <span class="s2">&quot;fast-neptune&quot;</span>

<span class="n">project</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_project</span><span class="p">(</span><span class="n">project_qualified_name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{user_name}</span><span class="s1">/</span><span class="si">{project_name}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Please enter your NeptuneML API token : ииииииии
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING: Instantiating Session without specifying a backend is deprecated and will be removed in future versions. For current behaviour use `neptune.init(...)` or `Session.with_default_backend(...)
WARNING: It is not secure to place API token in your source code. You should treat it as a password to your account. It is strongly recommended to use NEPTUNE_API_TOKEN environment variable instead. Remember not to upload source file with API token to any public repository.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we will start using <code>fast-neptune</code>.</p>
<p>First we will record the code used to load the data and learner. To do so, we simply add <code>#code</code> to the cell used to load the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fast_neptune.core</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#code dataloading.py</span>
<span class="kn">from</span> <span class="nn">fastai.vision</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ImageDataBunch</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet18</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we want to keep track of the number of epochs during training, and the learning rate we used. To do so we add <code>#property</code> to the cell we want to track.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#property</span>
<span class="n">n_epoch</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-2</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally we use <a href="/fast_neptune/core#fast_experiment"><code>fast_experiment</code></a> to create our experiment. Note that you must pass it the name of the notebook you are using for your experiments, and the global variables you are currently using to record each variable in the properties cells.</p>
<p>Here we will create an experiment, then record the validation accuracy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#code</span>
<span class="n">nb_name</span> <span class="o">=</span> <span class="s2">&quot;index.ipynb&quot;</span>
<span class="n">globs</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>

<span class="k">with</span> <span class="n">fast_experiment</span><span class="p">(</span><span class="n">project</span><span class="p">,</span><span class="n">nb_name</span><span class="p">,</span><span class="n">globs</span><span class="p">)</span> <span class="k">as</span> <span class="n">exp</span><span class="p">:</span>
    <span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">n_epoch</span><span class="p">,</span><span class="n">lr</span><span class="p">)</span>
    <span class="n">pred</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">()</span>
    
    <span class="n">score</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">exp</span><span class="o">.</span><span class="n">send_metric</span><span class="p">(</span><span class="s2">&quot;valid_accuracy&quot;</span><span class="p">,</span><span class="n">score</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://ui.neptune.ai/danywin/fast-neptune/e/FAS1-18
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.052504</td>
      <td>0.014153</td>
      <td>0.994603</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now if we go on the link provided by NeptuneML we can have a closer look at this experiment :</p>
<p>Here we can see the parameters that were registered, including epoch, learning rate, OS, and Python version.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/fast_neptune/imgs/parameters.PNG" alt="Parameters"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the source code tab, we can have a look at the bits of code we registered, here the dataloading.
<img src="/fast_neptune/imgs/code.PNG" alt="Code"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the artifacts we also have the modules used in this notebook with their version :</p>
<p><img src="/fast_neptune/imgs/requirements.PNG" alt="Requirements"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we logged the validation accuracy, which can be found in the Logs tab :</p>
<p><img src="/fast_neptune/imgs/valid_score.PNG" alt="Parameters"></p>

</div>
</div>
</div>
</div>
 

